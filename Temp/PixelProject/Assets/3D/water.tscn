[gd_scene load_steps=14 format=3 uid="uid://df4eyka0erqws"]

[ext_resource type="Script" uid="uid://bjw4vo4kncqf0" path="res://src/DisplayAndCamera/DisplayPixelRenderer.cs" id="1_lgx2c"]
[ext_resource type="Material" uid="uid://cr8yf6r3utjih" path="res://Temp/PixelProject/WaterSSRShader/water_mat.tres" id="1_s3kyq"]
[ext_resource type="Script" uid="uid://3tymjwcdughs" path="res://src/DisplayAndCamera/CameraRigController.cs" id="2_7nu6e"]
[ext_resource type="Shader" uid="uid://b8w6ukv0awrxw" path="res://Assets/Shaders/PixelShaders/pixel_art_upscale_v2.gdshader" id="5_oal72"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_uix6f"]
sky_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)
ground_horizon_color = Color(0.662243, 0.671743, 0.686743, 1)

[sub_resource type="Sky" id="Sky_mfl67"]
sky_material = SubResource("ProceduralSkyMaterial_uix6f")

[sub_resource type="Environment" id="Environment_lgx2c"]
background_mode = 2
sky = SubResource("Sky_mfl67")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="QuadMesh" id="QuadMesh_uix6f"]
size = Vector2(40, 40)
subdivide_width = 20
subdivide_depth = 20

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7nu6e"]

[sub_resource type="CylinderMesh" id="CylinderMesh_uix6f"]
material = SubResource("StandardMaterial3D_7nu6e")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_mfl67"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7nu6e"]
shader = ExtResource("5_oal72")
shader_parameter/shadow_boost = 1.2
shader_parameter/shadow_threshold = 0.46
shader_parameter/shadow_color_override = Color(1, 1, 1, 1)
shader_parameter/use_shadow_color_override = false
shader_parameter/light_boost = 1.05

[sub_resource type="ViewportTexture" id="ViewportTexture_oal72"]
viewport_path = NodePath("SubViewportMain")

[node name="Water" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_lgx2c")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866024, -0.433016, 0.250001, 0, 0.499998, 0.866027, -0.500003, 0.75, -0.43301, 0, 0, 0)
shadow_enabled = true

[node name="SubViewportMain" type="SubViewport" parent="."]
handle_input_locally = false
size = Vector2i(640, 360)
render_target_update_mode = 4

[node name="Water" type="MeshInstance3D" parent="SubViewportMain"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 0.999999, 0, -0.999999, -4.37114e-08, 0, 0, 0)
layers = 3
mesh = SubResource("QuadMesh_uix6f")
skeleton = NodePath("../../..")
surface_material_override/0 = ExtResource("1_s3kyq")

[node name="Objects" type="Node3D" parent="SubViewportMain"]
transform = Transform3D(0.745822, 0.069073, -0.662555, 0.594207, -0.518565, 0.614823, -0.30111, -0.852243, -0.427801, 2.23352, 4.25721, 3.67148)

[node name="CSGBox3D" type="CSGBox3D" parent="SubViewportMain/Objects"]
transform = Transform3D(0.935137, 0.250402, -0.250635, 0.191634, -0.952515, -0.236628, -0.297985, 0.17325, -0.938717, -2.43949, 5.35126, 1.43421)
layers = 2
size = Vector3(1, 3, 1)

[node name="CSGBox3D2" type="CSGBox3D" parent="SubViewportMain/Objects"]
transform = Transform3D(0.977745, 0.155711, 0.140607, 0.190255, -0.375589, -0.907048, -0.0884271, 0.913612, -0.396855, -1.13483, 3.03325, -1.90245)
size = Vector3(1, 3, 1)

[node name="MeshInstance3D" type="MeshInstance3D" parent="SubViewportMain/Objects"]
transform = Transform3D(0.968674, -0.228646, -0.0969102, 0.213088, 0.564882, 0.797184, -0.12753, -0.792862, 0.595909, -5.26339, 2.04469, 0.760215)
mesh = SubResource("CylinderMesh_uix6f")
skeleton = NodePath("../../Water")
surface_material_override/0 = SubResource("StandardMaterial3D_mfl67")

[node name="CameraRigYaw" type="Node3D" parent="SubViewportMain"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 6.56398, 9.61048)
script = ExtResource("2_7nu6e")

[node name="Camera3D" type="Camera3D" parent="SubViewportMain/CameraRigYaw"]
physics_interpolation_mode = 2
transform = Transform3D(1, 0, 0, 0, 0.819152, 0.573576, 0, -0.573576, 0.819152, 0, 0, 0)
projection = 1
current = true
size = 12.0

[node name="Display" type="Control" parent="." node_paths=PackedStringArray("_viewport", "_mainRendereSprite")]
clip_contents = true
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(1.01507, 1.01103)
size_flags_horizontal = 3
size_flags_vertical = 3
mouse_filter = 2
script = ExtResource("1_lgx2c")
_viewport = NodePath("../SubViewportMain")
_mainRendereSprite = NodePath("MainRenderSprite")

[node name="MainRenderSprite" type="Sprite2D" parent="Display"]
texture_filter = 2
material = SubResource("ShaderMaterial_7nu6e")
position = Vector2(-0.985153, 3.95636)
scale = Vector2(2.93853, 2.96452)
texture = SubResource("ViewportTexture_oal72")
centered = false
